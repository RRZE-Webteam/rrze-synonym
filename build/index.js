(()=>{"use strict";var e={n:n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},d:(n,t)=>{for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};const n=window.wp.blocks,t=window.React,r=window.wp.i18n,l=window.wp.richText,a=window.wp.blockEditor,o=window.wp.components,s=window.wp.element,i=window.wp.apiFetch;var y=e.n(i);const c="rrze/synonym";(0,l.registerFormatType)(c,{title:(0,r.__)("Synonym/Acronym","rrze-synonym"),tagName:"abbr",className:"rrze-syn",attributes:{title:"title",lang:"lang","data-pron":"data-pron"},edit:e=>{const{value:n,onChange:i,isActive:m}=e,[u,d]=(0,s.useState)([]),[_,p]=(0,s.useState)(!0),[g,b]=(0,s.useState)(null);(0,s.useEffect)((()=>{let e=!1;return async function(){p(!0),b(null);let n=1;const t=[];try{for(;;){const r=await y()({path:`/wp/v2/synonym?status=publish&per_page=100&page=${n}&orderby=title&order=asc&_fields=id,title,synonym,titleLang,meta`});if(e)return;if(t.push(...r),r.length<100)break;n++}d(t)}catch(n){e||b(n)}finally{e||p(!1)}}(),()=>{e=!0}}),[]);const v=(0,s.useMemo)((()=>(u||[]).map((e=>{var n,t,l,a;return{value:String(e.id),label:e?.title?.rendered||(0,r.__)("(no title)","rrze-synonym"),long:null!==(n=null!==(t=e?.synonym)&&void 0!==t?t:e?.meta?.synonym)&&void 0!==n?n:"",lang:null!==(l=null!==(a=e?.titleLang)&&void 0!==a?a:e?.meta?.titleLang)&&void 0!==l?l:""}}))),[u]),[h,z]=(0,s.useState)(!1),[f,w]=(0,s.useState)(""),E=(0,s.useRef)(),S=(0,l.getActiveFormat)(n,c);return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.RichTextShortcut,{type:"primaryShift",character:"S",onUse:()=>z(!0)}),(0,t.createElement)("span",{ref:E},(0,t.createElement)(a.RichTextToolbarButton,{icon:"translation",title:(0,r.__)("Synonym/Acronym","rrze-synonym"),onClick:()=>z((e=>!e)),isActive:m})),h&&(0,t.createElement)(o.Popover,{anchorRef:E.current,variant:"toolbar",onClose:()=>z(!1)},(0,t.createElement)("div",{style:{padding:12,width:360,maxWidth:"90vw"}},_&&(0,t.createElement)(o.Flex,{align:"center",gap:8},(0,t.createElement)(o.Spinner,null),(0,t.createElement)("span",null,(0,r.__)("Loading synonymsâ€¦","rrze-synonym"))),!_&&g&&(0,t.createElement)(o.Notice,{status:"error",isDismissible:!1},(0,r.__)("Failed to load synonyms. Check your REST setup.","rrze-synonym")),!_&&!g&&(0,t.createElement)(o.ComboboxControl,{label:(0,r.__)("Choose a synonym","rrze-synonym"),help:(0,r.__)("Type to search by title","rrze-synonym"),value:f,onChange:w,options:v}),(0,t.createElement)(o.Flex,{style:{marginTop:10},justify:"flex-end",gap:8},!!S&&(0,t.createElement)(o.FlexItem,null,(0,t.createElement)(o.Button,{variant:"secondary",onClick:()=>{i((0,l.removeFormat)(n,c)),z(!1)}},(0,r.__)("Remove","rrze-synonym"))),(0,t.createElement)(o.FlexItem,null,(0,t.createElement)(o.Button,{variant:"primary",onClick:()=>{if(!f)return;const e=v.find((e=>e.value===f));if(!e)return;const t={};e.long&&(t.title=e.long),e.lang&&(t.lang=e.lang);let r=n;if(r.start===r.end){const n=e.label||"";if(n){const e=r.text.length;r=(0,l.insert)(r,n);const t=r.text.length-e;r={...r,start:r.end-t,end:r.end}}}r=(0,l.applyFormat)(r,{type:c,attributes:t}),i(r),z(!1),w("")},disabled:!f},S?(0,r.__)("Update","rrze-synonym"):(0,r.__)("Apply","rrze-synonym")))))))}});const m=JSON.parse('{"u2":"create-block/rrze-synonym"}'),u=window.wp.data,d=window.wp.serverSideRender;var _=e.n(d);(0,n.registerBlockType)(m.u2,{edit:function({attributes:e,setAttributes:n}){const{register:l,tag:i,id:y,hstart:c,order:m,sort:d,lang:p,additional_class:g,color:b,load_open:v,expand_all_link:h,hide_title:z,hide_accordion:f,synonymstyle:w,synonym:E}=e,S=(0,a.useBlockProps)(),[C,x]=(0,s.useState)([""]),[k,F]=(0,s.useState)([""]),[T,R]=(0,s.useState)([""]),A=(0,u.useSelect)((e=>e("core").getEntityRecords("taxonomy","synonym_category")),[]),q=[{label:(0,r.__)("all","rrze-synonym"),value:""}];A&&Object.values(A).forEach((e=>{q.push({label:e.name,value:e.slug})}));const O=(0,u.useSelect)((e=>e("core").getEntityRecords("taxonomy","synonym_tag")),[]),j=[{label:(0,r.__)("all","rrze-synonym"),value:""}];O&&Object.values(O).forEach((e=>{j.push({label:e.name,value:e.slug})}));const B=(0,u.useSelect)((e=>e("core").getEntityRecords("postType","synonym",{per_page:-1,orderby:"title",order:"asc"})),[]),L=[{label:(0,r.__)("all","rrze-synonym"),value:0}];B&&Object.values(B).forEach((e=>{L.push({label:e.title.rendered?e.title.rendered:(0,r.__)("No title","rrze-synonym"),value:e.id})}));const N=[{label:(0,r.__)("all","rrze-faq"),value:""},{label:(0,r.__)("German","rrze-faq"),value:"de"},{label:(0,r.__)("English","rrze-faq"),value:"en"},{label:(0,r.__)("French","rrze-faq"),value:"fr"},{label:(0,r.__)("Spanish","rrze-faq"),value:"es"},{label:(0,r.__)("Russian","rrze-faq"),value:"ru"},{label:(0,r.__)("Chinese","rrze-faq"),value:"zh"}];return(0,r.__)("-- hidden --","rrze-synonym"),(0,r.__)("A - Z","rrze-synonym"),(0,r.__)("Tagcloud","rrze-synonym"),(0,r.__)("Tabs","rrze-synonym"),(0,r.__)("Title","rrze-synonym"),(0,r.__)("ID","rrze-synonym"),(0,r.__)("Sort field","rrze-synonym"),(0,r.__)("ASC","rrze-synonym"),(0,r.__)("DESC","rrze-synonym"),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.InspectorControls,null,(0,t.createElement)(o.PanelBody,null,(0,t.createElement)(o.SelectControl,{label:(0,r.__)("synonym","rrze-synonym"),help:(0,r.__)("Show a selection of individual Synonyms","rrze-synonym"),value:T,options:L,onChange:e=>{R(e),n({id:String(e)})},multiple:!0}),(0,t.createElement)(o.SelectControl,{label:(0,r.__)("Language","rrze-synonym"),help:(0,r.__)("Show only Synonyms matching the selected language.","rrze-synonym"),value:p,options:N,onChange:e=>n({lang:e})}))),(0,t.createElement)("div",{...S},(0,t.createElement)(_(),{block:"create-block/rrze-synonym",attributes:e})))},save:function(){return null}})})();